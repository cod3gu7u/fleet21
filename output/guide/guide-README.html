<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="language" content="en" />
        <link href="./assets/9e9499b6/css/bootstrap.css" rel="stylesheet">
<link href="./assets/1374a5fc/solarized_light.css" rel="stylesheet">
<link href="./assets/1fb4caa7/style.css" rel="stylesheet">
<script src="./assets/9568987e/jquery.js"></script>
<script src="./assets/9e9499b6/js/bootstrap.js"></script>
<script src="./assets/6746678/jssearch.js"></script>    <title>The Definitive Guide to Yii 2.0</title>
</head>
<body>

<div class="wrap">
    <nav id="w18" class="navbar-inverse navbar-fixed-top navbar" role="navigation"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#w18-collapse"><span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span></button><a class="navbar-brand" href="./guide-index.html">The Definitive Guide to Yii 2.0</a></div><div id="w18-collapse" class="collapse navbar-collapse"><ul id="w19" class="navbar-nav nav"><li><a href="./guide-README.html">Guide</a></li></ul><div class="navbar-form navbar-left" role="search">
  <div class="form-group">
    <input id="searchbox" type="text" class="form-control" placeholder="Search">
  </div>
</div>
</div></nav>
    <div id="search-resultbox" style="display: none;" class="modal-content">
        <ul id="search-results">
        </ul>
    </div>

    
<div class="row">
    <div class="col-md-2">
                <div id="navigation" class="list-group"><a class="list-group-item" href="#navigation-0" data-toggle="collapse" data-parent="#navigation">What is this? &lt;a name=&quot;what&quot;&gt;&lt;/a&gt; <b class="caret"></b></a><div id="navigation-0" class="submenu panel-collapse collapse"><a class="list-group-item" href="http://markdown.cebe.cc/try?flavor=default">try it!</a>
<a class="list-group-item" href="http://markdown.cebe.cc/try?flavor=gfm">try it!</a>
<a class="list-group-item" href="./guide-.html">#25</a>
<a class="list-group-item" href="http://markdown.cebe.cc/try?flavor=extra">try it!</a>
<a class="list-group-item" href="https://github.com/cebe/markdown/issues/new">suggest</a></div>
<a class="list-group-item" href="#navigation-1" data-toggle="collapse" data-parent="#navigation">Who is using it? <b class="caret"></b></a><div id="navigation-1" class="submenu panel-collapse collapse"><a class="list-group-item" href="http://www.yiiframework.com/doc-2.0/">API-docs and the definitive guide</a>
<a class="list-group-item" href="./guide-.html">Yii Framework</a>
<a class="list-group-item" href="https://github.com/yiisoft/yii2">2.0</a></div>
<a class="list-group-item" href="#navigation-2" data-toggle="collapse" data-parent="#navigation">Installation &lt;a name=&quot;installation&quot;&gt;&lt;/a&gt; <b class="caret"></b></a><div id="navigation-2" class="submenu panel-collapse collapse"></div>
<a class="list-group-item" href="#navigation-3" data-toggle="collapse" data-parent="#navigation">Usage &lt;a name=&quot;usage&quot;&gt;&lt;/a&gt; <b class="caret"></b></a><div id="navigation-3" class="submenu panel-collapse collapse"></div>
<a class="list-group-item" href="#navigation-4" data-toggle="collapse" data-parent="#navigation">In your PHP project <b class="caret"></b></a><div id="navigation-4" class="submenu panel-collapse collapse"></div>
<a class="list-group-item" href="#navigation-5" data-toggle="collapse" data-parent="#navigation">The command line script <b class="caret"></b></a><div id="navigation-5" class="submenu panel-collapse collapse"></div>
<a class="list-group-item" href="#navigation-6" data-toggle="collapse" data-parent="#navigation">Extensions <b class="caret"></b></a><div id="navigation-6" class="submenu panel-collapse collapse"><a class="list-group-item" href="https://github.com/Bogardo/markdown-codepen">Bogardo/markdown-codepen</a>
<a class="list-group-item" href="https://github.com/kartik-v/yii2-markdown">kartik-v/yii2-markdown</a>
<a class="list-group-item" href="https://github.com/cebe/markdown-latex">cebe/markdown-latex</a>
<a class="list-group-item" href="https://github.com/cebe/markdown/edit/master/README.md#L98">add yours!</a></div>
<a class="list-group-item" href="#navigation-7" data-toggle="collapse" data-parent="#navigation">Extending the language &lt;a name=&quot;extend&quot;&gt;&lt;/a&gt; <b class="caret"></b></a><div id="navigation-7" class="submenu panel-collapse collapse"></div>
<a class="list-group-item" href="#navigation-8" data-toggle="collapse" data-parent="#navigation">Adding block elements <b class="caret"></b></a><div id="navigation-8" class="submenu panel-collapse collapse"></div>
<a class="list-group-item" href="#navigation-9" data-toggle="collapse" data-parent="#navigation">Adding inline elements <b class="caret"></b></a><div id="navigation-9" class="submenu panel-collapse collapse"></div>
<a class="list-group-item" href="#navigation-10" data-toggle="collapse" data-parent="#navigation">Composing your own Markdown flavor <b class="caret"></b></a><div id="navigation-10" class="submenu panel-collapse collapse"></div>
<a class="list-group-item" href="#navigation-11" data-toggle="collapse" data-parent="#navigation">Acknowledgements &lt;a name=&quot;ack&quot;&gt;&lt;/a&gt; <b class="caret"></b></a><div id="navigation-11" class="submenu panel-collapse collapse"></div>
<a class="list-group-item" href="#navigation-12" data-toggle="collapse" data-parent="#navigation">FAQ &lt;a name=&quot;faq&quot;&gt;&lt;/a&gt; <b class="caret"></b></a><div id="navigation-12" class="submenu panel-collapse collapse"></div>
<a class="list-group-item" href="#navigation-13" data-toggle="collapse" data-parent="#navigation">Why another markdown parser? <b class="caret"></b></a><div id="navigation-13" class="submenu panel-collapse collapse"></div>
<a class="list-group-item" href="#navigation-14" data-toggle="collapse" data-parent="#navigation">Where do I report bugs or rendering issues? <b class="caret"></b></a><div id="navigation-14" class="submenu panel-collapse collapse"></div>
<a class="list-group-item" href="#navigation-15" data-toggle="collapse" data-parent="#navigation">How can I contribute to this library? <b class="caret"></b></a><div id="navigation-15" class="submenu panel-collapse collapse"></div>
<a class="list-group-item" href="#navigation-16" data-toggle="collapse" data-parent="#navigation">Am I free to use this? <b class="caret"></b></a><div id="navigation-16" class="submenu panel-collapse collapse"></div>
<a class="list-group-item" href="#navigation-17" data-toggle="collapse" data-parent="#navigation">Contact <b class="caret"></b></a><div id="navigation-17" class="submenu panel-collapse collapse"></div></div>    </div>
    <div class="col-md-9 guide-content" role="main">
        <h1>A super fast, highly extensible markdown parser for PHP <span id="a-super-fast-highly-extensible-markdown-parser-for-php"></span><a href="#a-super-fast-highly-extensible-markdown-parser-for-php" class="hashlink">&para;</a></h1>
<div class="toc"><ol><li><a href="#what-is-this">What is this? </a></li>
<li><a href="#installation">Installation </a></li>
<li><a href="#usage">Usage </a></li>
<li><a href="#extensions">Extensions</a></li>
<li><a href="#extending-the-language">Extending the language </a></li>
<li><a href="#acknowledgements">Acknowledgements </a></li>
<li><a href="#faq">FAQ </a></li>
<li><a href="#contact">Contact</a></li></ol></div>
<p><a href="https://packagist.org/packages/cebe/markdown"><img src="https://poser.pugx.org/cebe/markdown/v/stable.png" alt="Latest Stable Version" /></a>
<a href="https://packagist.org/packages/cebe/markdown"><img src="https://poser.pugx.org/cebe/markdown/downloads.png" alt="Total Downloads" /></a>
<a href="http://travis-ci.org/cebe/markdown"><img src="https://secure.travis-ci.org/cebe/markdown.png" alt="Build Status" /></a>
<a href="http://hhvm.h4cc.de/package/cebe/markdown"><img src="http://hhvm.h4cc.de/badge/cebe/markdown.png" alt="Tested against HHVM" /></a>
<a href="https://scrutinizer-ci.com/g/cebe/markdown/"><img src="https://scrutinizer-ci.com/g/cebe/markdown/badges/coverage.png?s=db6af342d55bea649307ef311fbd536abb9bab76" alt="Code Coverage" /></a>
<a href="https://scrutinizer-ci.com/g/cebe/markdown/"><img src="https://scrutinizer-ci.com/g/cebe/markdown/badges/quality-score.png?s=17448ca4d140429fd687c58ff747baeb6568d528" alt="Scrutinizer Quality Score" /></a></p>
<h2>What is this? <a name="what"></a> <span id="what-is-this"></span><a href="#what-is-this" class="hashlink">&para;</a></h2><p>A set of <a href="http://php.net/" title="PHP is a popular general-purpose scripting language that is especially suited to web development.">PHP</a> classes, each representing a <a href="http://en.wikipedia.org/wiki/Markdown" title="Markdown on Wikipedia">Markdown</a> flavor, and a command line tool
for converting markdown files to HTML files.</p>
<p>The implementation focus is to be <strong>fast</strong> (see <a href="https://github.com/kzykhys/Markbench#readme" title="kzykhys/Markbench on github">benchmark</a>) and <strong>extensible</strong>.
Parsing Markdown to HTML is as simple as calling a single method (see <a href="#usage">Usage</a>) providing a solid implementation
that gives most expected results even in non-trivial edge cases.</p>
<p>Extending the Markdown language with new elements is as simple as adding a new method to the class that converts the
markdown text to the expected output in HTML. This is possible without dealing with complex and error prone regular expressions.
It is also possible to hook into the markdown structure and add elements or read meta information using the internal representation
of the Markdown text as an abstract syntax tree (see <a href="#extend">Extending the language</a>).</p>
<p>Currently the following markdown flavors are supported:</p>
<ul>
<li><strong>Traditional Markdown</strong> according to <a href="http://daringfireball.net/projects/markdown/syntax">http://daringfireball.net/projects/markdown/syntax</a> (<a href="http://markdown.cebe.cc/try?flavor=default">try it!</a>).</li>
<li><strong>Github flavored Markdown</strong> according to <a href="https://help.github.com/articles/github-flavored-markdown">https://help.github.com/articles/github-flavored-markdown</a> (<a href="http://markdown.cebe.cc/try?flavor=gfm">try it!</a>).</li>
<li><strong>Markdown Extra</strong> according to <a href="http://michelf.ca/projects/php-markdown/extra/">http://michelf.ca/projects/php-markdown/extra/</a> (currently not fully supported WIP see <a href="https://github.com/cebe/markdown/issues/25" title="issue #25">#25</a>, <a href="http://markdown.cebe.cc/try?flavor=extra">try it!</a>)</li>
<li>Any mixed Markdown flavor you like because of its highly extensible structure (See documentation below).</li>
</ul>
<p>Future plans are to support:</p>
<ul>
<li>Smarty Pants <a href="http://daringfireball.net/projects/smartypants/">http://daringfireball.net/projects/smartypants/</a></li>
<li>... (Feel free to <a href="https://github.com/cebe/markdown/issues/new">suggest</a> further additions!)</li>
</ul>
<h3>Who is using it? <span id="who-is-using-it"></span><a href="#who-is-using-it" class="hashlink">&para;</a></h3><ul>
<li>It powers the <a href="http://www.yiiframework.com/doc-2.0/">API-docs and the definitive guide</a> for the <a href="http://www.yiiframework.com/" title="The Yii PHP Framework">Yii Framework</a> <a href="https://github.com/yiisoft/yii2">2.0</a>.</li>
</ul>
<h2>Installation <a name="installation"></a> <span id="installation"></span><a href="#installation" class="hashlink">&para;</a></h2><p><a href="http://www.php.net/downloads.php">PHP 5.4 or higher</a> is required to use it.
It will also run on facebook's <a href="http://hhvm.com/">hhvm</a>.</p>
<p>Installation is recommended to be done via <a href="https://getcomposer.org/" title="The PHP package manager">composer</a> by running:</p>
<pre><code class="hljs nginx"><span class="hljs-title">composer</span> require cebe/markdown <span class="hljs-string">"~1.0.1"</span>
</code></pre>
<p>Alternatively you can add the following to the <code>require</code> section in your <code>composer.json</code> manually:</p>
<pre><code class="hljs json language-json"><span class="hljs-string">"cebe/markdown"</span>: <span class="hljs-string">"~1.0.1"</span>
</code></pre>
<p>Run <code>composer update</code> afterwards.</p>
<h2>Usage <a name="usage"></a> <span id="usage"></span><a href="#usage" class="hashlink">&para;</a></h2><h3>In your PHP project <span id="in-your-php-project"></span><a href="#in-your-php-project" class="hashlink">&para;</a></h3><p>To parse your markdown you need only two lines of code. The first one is to choose the markdown flavor as
one of the following:</p>
<ul>
<li>Traditional Markdown: <code>$parser = new \cebe\markdown\Markdown();</code></li>
<li>Github Flavored Markdown: <code>$parser = new \cebe\markdown\GithubMarkdown();</code></li>
<li>Markdown Extra: <code>$parser = new \cebe\markdown\MarkdownExtra();</code></li>
</ul>
<p>The next step is to call the <code>parse()</code>-method for parsing the text using the full markdown language
or calling the <code>parseParagraph()</code>-method to parse only inline elements.</p>
<p>Here are some examples:</p>
<pre><code class="hljs php language-php"><span class="hljs-comment">// traditional markdown and parse full text</span>
<span class="hljs-variable">$parser</span> = <span class="hljs-keyword">new</span> \cebe\markdown\Markdown();
<span class="hljs-variable">$parser</span>-&gt;parse(<span class="hljs-variable">$markdown</span>);

<span class="hljs-comment">// use github markdown</span>
<span class="hljs-variable">$parser</span> = <span class="hljs-keyword">new</span> \cebe\markdown\GithubMarkdown();
<span class="hljs-variable">$parser</span>-&gt;parse(<span class="hljs-variable">$markdown</span>);

<span class="hljs-comment">// use markdown extra</span>
<span class="hljs-variable">$parser</span> = <span class="hljs-keyword">new</span> \cebe\markdown\MarkdownExtra();
<span class="hljs-variable">$parser</span>-&gt;parse(<span class="hljs-variable">$markdown</span>);

<span class="hljs-comment">// parse only inline elements (useful for one-line descriptions)</span>
<span class="hljs-variable">$parser</span> = <span class="hljs-keyword">new</span> \cebe\markdown\GithubMarkdown();
<span class="hljs-variable">$parser</span>-&gt;parseParagraph(<span class="hljs-variable">$markdown</span>);
</code></pre>
<p>You may optionally set one of the following options on the parser object:</p>
<p>For all Markdown Flavors:</p>
<ul>
<li><code>$parser-&gt;html5 = true</code> to enable HTML5 output instead of HTML4.</li>
<li><code>$parser-&gt;keepListStartNumber = true</code> to enable keeping the numbers of ordered lists as specified in the markdown.
The default behavior is to always start from 1 and increment by one regardless of the number in markdown.</li>
</ul>
<p>For GithubMarkdown:</p>
<ul>
<li><code>$parser-&gt;enableNewlines = true</code> to convert all newlines to <code>&lt;br/&gt;</code>-tags. By default only newlines with two preceding spaces are converted to <code>&lt;br/&gt;</code>-tags. </li>
</ul>
<p>It is recommended to use UTF-8 encoding for the input strings. Other encodings are currently not tested.</p>
<h3>The command line script <span id="the-command-line-script"></span><a href="#the-command-line-script" class="hashlink">&para;</a></h3><p>You can use it to render this readme:</p>
<pre><code class="hljs ">bin/markdown README.md &gt; README.html
</code></pre>
<p>Using github flavored markdown:</p>
<pre><code class="hljs sql">bin/markdown <span class="hljs-comment">--flavor=gfm README.md &gt; README.html</span>
</code></pre>
<p>or convert the original markdown description to html using the unix pipe:</p>
<pre><code class="hljs nginx"><span class="hljs-title">curl</span> <span class="hljs-url">http://daringfireball.net/projects/markdown/syntax.text</span> | bin/markdown &gt; md.html
</code></pre>
<p>Here is the full Help output you will see when running <code>bin/markdown --help</code>:</p>
<pre><code class="hljs nginx"><span class="hljs-title">PHP</span> Markdown to HTML converter
------------------------------

by Carsten Brandt &lt;mail<span class="hljs-variable">@cebe</span>.cc&gt;

Usage:
    bin/markdown [--flavor=&lt;flavor&gt;] [--full] [file.md]

    --flavor  specifies the markdown flavor to use. If omitted the original markdown by John Gruber [<span class="hljs-number">1</span>] will be used.
              Available flavors:

              gfm   - Github flavored markdown [<span class="hljs-number">2</span>]
              extra - Markdown Extra [<span class="hljs-number">3</span>]

    --full    ouput a full HTML page with head and body. If not given, only the parsed markdown will be output.

    --help    shows this usage information.

    If <span class="hljs-built_in">no</span> file is specified input will be read from STDIN.

Examples:

    Render a file with original markdown:

        bin/markdown README.md &gt; README.html

    Render a file using gihtub flavored markdown:

        bin/markdown --flavor=gfm README.md &gt; README.html

    Convert the original markdown description to html using STDIN:

        curl <span class="hljs-url">http://daringfireball.net/projects/markdown/syntax.text</span> | bin/markdown &gt; md.html


[<span class="hljs-number">1</span>] <span class="hljs-url">http://daringfireball.net/projects/markdown/syntax</span>
[<span class="hljs-number">2</span>] <span class="hljs-url">https://help.github.com/articles/github-flavored-markdown</span>
[<span class="hljs-number">3</span>] <span class="hljs-url">http://michelf.ca/projects/php-markdown/extra/</span>
</code></pre>
<h2>Extensions <span id="extensions"></span><a href="#extensions" class="hashlink">&para;</a></h2><p>Here are some extensions to this library:</p>
<ul>
<li><a href="https://github.com/Bogardo/markdown-codepen">Bogardo/markdown-codepen</a> - shortcode to embed codepens from <a href="http://codepen.io/">http://codepen.io/</a> in markdown.</li>
<li><a href="https://github.com/kartik-v/yii2-markdown">kartik-v/yii2-markdown</a> - Advanced Markdown editing and conversion utilities for Yii Framework 2.0.</li>
<li><a href="https://github.com/cebe/markdown-latex">cebe/markdown-latex</a> - Convert Markdown to LaTeX and PDF</li>
<li>... <a href="https://github.com/cebe/markdown/edit/master/README.md#L98">add yours!</a></li>
</ul>
<h2>Extending the language <a name="extend"></a> <span id="extending-the-language"></span><a href="#extending-the-language" class="hashlink">&para;</a></h2><p>Markdown consists of two types of language elements, I'll call them block and inline elements simlar to what you have in
HTML with <code>&lt;div&gt;</code> and <code>&lt;span&gt;</code>. Block elements are normally spreads over several lines and are separated by blank lines.
The most basic block element is a paragraph (<code>&lt;p&gt;</code>).
Inline elements are elements that are added inside of block elements i.e. inside of text.</p>
<p>This markdown parser allows you to extend the markdown language by changing existing elements behavior and also adding
new block and inline elements. You do this by extending from the parser class and adding/overriding class methods and
properties. For the different element types there are different ways to extend them as you will see in the following sections.</p>
<h3>Adding block elements <span id="adding-block-elements"></span><a href="#adding-block-elements" class="hashlink">&para;</a></h3><p>The markdown is parsed line by line to identify each non-empty line as one of the block element types.
To identify a line as the beginning of a block element it calls all protected class methods who's name begins with <code>identify</code>.
An identify function returns true if it has identified the block element it is responsible for or false if not.
In the following example we will implement support for <a href="https://help.github.com/articles/github-flavored-markdown#fenced-code-blocks" title="Fenced code block feature of github flavored markdown">fenced code blocks</a> which are part of the github flavored markdown.</p>
<pre><code class="hljs php language-php"><span class="hljs-preprocessor">&lt;?php</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyMarkdown</span> <span class="hljs-keyword">extends</span> \<span class="hljs-title">cebe</span>\<span class="hljs-title">markdown</span>\<span class="hljs-title">Markdown</span>
</span>{
	<span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">identifyLine</span><span class="hljs-params">(<span class="hljs-variable">$line</span>, <span class="hljs-variable">$lines</span>, <span class="hljs-variable">$current</span>)</span>
	</span>{
		<span class="hljs-comment">// if a line starts with at least 3 backticks it is identified as a fenced code block</span>
		<span class="hljs-keyword">if</span> (strncmp(<span class="hljs-variable">$line</span>, <span class="hljs-string">'```'</span>, <span class="hljs-number">3</span>) === <span class="hljs-number">0</span>) {
			<span class="hljs-keyword">return</span> <span class="hljs-string">'fencedCode'</span>;
		}
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">parent</span>::identifyLine(<span class="hljs-variable">$lines</span>, <span class="hljs-variable">$current</span>);
	}

	<span class="hljs-comment">// ...</span>
}
</code></pre>
<p>In the above, <code>$line</code> is a string containing the content of the current line and is equal to <code>$lines[$current]</code>.
You may use <code>$lines</code> and <code>$current</code> to check other lines than the current line. In most cases you can ignore these parameters.</p>
<p>Parsing of a block element is done in two steps:</p>
<ol>
<li><p>"consuming" all the lines belonging to it. In most cases this is iterating over the lines starting from the identified
line until a blank line occurs. This step is implemented by a method named <code>consume{blockName}()</code> where <code>{blockName}</code>
is the same name as used for the identify function above. The consume method also takes the lines array
and the number of the current line. It will return two arguments: an array representing the block element in the abstract syntax tree
of the markdown document and the line number to parse next. In the abstract syntax array the first element refers to the name of
the element, all other array elements can be freely defined by yourself.
In our example we will implement it like this:</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">consumeFencedCode</span><span class="hljs-params">(<span class="hljs-variable">$lines</span>, <span class="hljs-variable">$current</span>)</span>
</span>{
	<span class="hljs-comment">// create block array</span>
	<span class="hljs-variable">$block</span> = [
		<span class="hljs-string">'fencedCode'</span>,
		<span class="hljs-string">'content'</span> =&gt; [],
	];
	<span class="hljs-variable">$line</span> = rtrim(<span class="hljs-variable">$lines</span>[<span class="hljs-variable">$current</span>]);

	<span class="hljs-comment">// detect language and fence length (can be more than 3 backticks)</span>
	<span class="hljs-variable">$fence</span> = substr(<span class="hljs-variable">$line</span>, <span class="hljs-number">0</span>, <span class="hljs-variable">$pos</span> = strrpos(<span class="hljs-variable">$line</span>, <span class="hljs-string">'`'</span>) + <span class="hljs-number">1</span>);
	<span class="hljs-variable">$language</span> = substr(<span class="hljs-variable">$line</span>, <span class="hljs-variable">$pos</span>);
	<span class="hljs-keyword">if</span> (!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$language</span>)) {
		<span class="hljs-variable">$block</span>[<span class="hljs-string">'language'</span>] = <span class="hljs-variable">$language</span>;
	}

	<span class="hljs-comment">// consume all lines until ```</span>
	<span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-variable">$current</span> + <span class="hljs-number">1</span>, <span class="hljs-variable">$count</span> = count(<span class="hljs-variable">$lines</span>); <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$count</span>; <span class="hljs-variable">$i</span>++) {
		<span class="hljs-keyword">if</span> (rtrim(<span class="hljs-variable">$line</span> = <span class="hljs-variable">$lines</span>[<span class="hljs-variable">$i</span>]) !== <span class="hljs-variable">$fence</span>) {
			<span class="hljs-variable">$block</span>[<span class="hljs-string">'content'</span>][] = <span class="hljs-variable">$line</span>;
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-comment">// stop consuming when code block is over</span>
			<span class="hljs-keyword">break</span>;
		}
	}
	<span class="hljs-keyword">return</span> [<span class="hljs-variable">$block</span>, <span class="hljs-variable">$i</span>];
}
</code></pre>
</li>
<li><p>"rendering" the element. After all blocks have been consumed, they are being rendered using the
<code>render{elementName}()</code>-method where <code>elementName</code> refers to the name of the element in the abstract syntax tree:</p>
<pre><code class="hljs php language-php"><span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">renderFencedCode</span><span class="hljs-params">(<span class="hljs-variable">$block</span>)</span>
</span>{
	<span class="hljs-variable">$class</span> = <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$block</span>[<span class="hljs-string">'language'</span>]) ? <span class="hljs-string">' class="language-'</span> . <span class="hljs-variable">$block</span>[<span class="hljs-string">'language'</span>] . <span class="hljs-string">'"'</span> : <span class="hljs-string">''</span>;
	<span class="hljs-keyword">return</span> <span class="hljs-string">"&lt;pre&gt;&lt;code$class&gt;"</span> . htmlspecialchars(implode(<span class="hljs-string">"\n"</span>, <span class="hljs-variable">$block</span>[<span class="hljs-string">'content'</span>]) . <span class="hljs-string">"\n"</span>, ENT_NOQUOTES, <span class="hljs-string">'UTF-8'</span>) . <span class="hljs-string">'&lt;/code&gt;&lt;/pre&gt;'</span>;
}
</code></pre>
<p>You may also add code highlighting here. In general it would also be possible to render ouput in a different language than
HTML for example LaTeX.</p>
</li>
</ol>
<h3>Adding inline elements <span id="adding-inline-elements"></span><a href="#adding-inline-elements" class="hashlink">&para;</a></h3><p>Adding inline elements is different from block elements as they are parsed using markers in the text.
An inline element is identified by a marker that marks the beginning of an inline element (e.g. <code>[</code> will mark a possible
beginning of a link or <code>`</code> will mark inline code).</p>
<p>Parsing methods for inline elements are also protected and identified by the prefix <code>parse</code>. Additionally a <code>@marker</code> annotation
in PHPDoc is needed to register the parse function for one or multiple markers.
The method will then be called when a marker is found in the text. As an argument it takes the text starting at the position of the marker.
The parser method will return an array containing the element of the abstract sytnax tree and an offset of text it has
parsed from the input markdown. All text up to this offset will be removed from the markdown before the next marker will be searched.</p>
<p>As an example, we will add support for the <a href="https://help.github.com/articles/github-flavored-markdown#strikethrough" title="Strikethrough feature of github flavored markdown">strikethrough</a> feature of github flavored markdown:</p>
<pre><code class="hljs php language-php"><span class="hljs-preprocessor">&lt;?php</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyMarkdown</span> <span class="hljs-keyword">extends</span> \<span class="hljs-title">cebe</span>\<span class="hljs-title">markdown</span>\<span class="hljs-title">Markdown</span>
</span>{
	<span class="hljs-comment">/**
	 * <span class="hljs-doctag">@marker</span> ~~
	 */</span>
	<span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parseStrike</span><span class="hljs-params">(<span class="hljs-variable">$markdown</span>)</span>
	</span>{
		<span class="hljs-comment">// check whether the marker really represents a strikethrough (i.e. there is a closing ~~)</span>
		<span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">'/^~~(.+?)~~/'</span>, <span class="hljs-variable">$markdown</span>, <span class="hljs-variable">$matches</span>)) {
			<span class="hljs-keyword">return</span> [
			    <span class="hljs-comment">// return the parsed tag as an element of the abstract syntax tree and call `parseInline()` to allow</span>
			    <span class="hljs-comment">// other inline markdown elements inside this tag</span>
				[<span class="hljs-string">'strike'</span>, <span class="hljs-variable">$this</span>-&gt;parseInline(<span class="hljs-variable">$matches</span>[<span class="hljs-number">1</span>])],
				<span class="hljs-comment">// return the offset of the parsed text</span>
				strlen(<span class="hljs-variable">$matches</span>[<span class="hljs-number">0</span>])
			];
		}
		<span class="hljs-comment">// in case we did not find a closing ~~ we just return the marker and skip 2 characters</span>
		<span class="hljs-keyword">return</span> [[<span class="hljs-string">'text'</span>, <span class="hljs-string">'~~'</span>], <span class="hljs-number">2</span>];
	}

	<span class="hljs-comment">// rendering is the same as for block elements, we turn the abstract syntax array into a string.</span>
	<span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">renderStrike</span><span class="hljs-params">(<span class="hljs-variable">$element</span>)</span>
	</span>{
		<span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;del&gt;'</span> . <span class="hljs-variable">$this</span>-&gt;renderAbsy(<span class="hljs-variable">$element</span>[<span class="hljs-number">1</span>]) . <span class="hljs-string">'&lt;/del&gt;'</span>;
	}
}
</code></pre>
<h3>Composing your own Markdown flavor <span id="composing-your-own-markdown-flavor"></span><a href="#composing-your-own-markdown-flavor" class="hashlink">&para;</a></h3><p>TBD</p>
<h2>Acknowledgements <a name="ack"></a> <span id="acknowledgements"></span><a href="#acknowledgements" class="hashlink">&para;</a></h2><p>I'd like to thank <a href="https://github.com/erusev" title="Emanuil Rusev">@erusev</a> for creating <a href="http://parsedown.org/" title="The Parsedown PHP Markdown parser">Parsedown</a> which heavily influenced this work and provided
the idea of the line based parsing approach.</p>
<h2>FAQ <a name="faq"></a> <span id="faq"></span><a href="#faq" class="hashlink">&para;</a></h2><h3>Why another markdown parser? <span id="why-another-markdown-parser"></span><a href="#why-another-markdown-parser" class="hashlink">&para;</a></h3><p>While reviewing PHP markdown parsers for choosing one to use bundled with the <a href="https://github.com/yiisoft/yii2">Yii framework 2.0</a>
I found that most of the implementations use regex to replace patterns instead
of doing real parsing. This way extending them with new language elements is quite hard
as you have to come up with a complex regex, that matches your addition but does not mess
with other elements. Such additions are very common as you see on github which supports referencing
issues, users and commits in the comments.
A <a href="http://en.wikipedia.org/wiki/Parsing#Types_of_parser">real parser</a> should use context aware methods that walk trough the text and
parse the tokens as they find them. The only implentation that I have found that uses
this approach is <a href="http://parsedown.org/" title="The Parsedown PHP Markdown parser">Parsedown</a> which also shows that this implementation is <a href="https://github.com/kzykhys/Markbench#readme" title="kzykhys/Markbench on github">much faster</a>
than the regex way. Parsedown however is an implementation that focuses on speed and implements
its own flavor (mainly github flavored markdown) in one class and at the time of this writing was
not easily extensible.</p>
<p>Given the situation above I decided to start my own implementation using the parsing approach
from Parsedown and making it extensible creating a class for each markdown flavor that extend each
other in the way that also the markdown languages extend each other.
This allows you to choose between markdown language flavors and also provides a way to compose your
own flavor picking the best things from all.
I chose this approach as it is easier to implement and also more intuitive approach compared
to using callbacks to inject functionallity into the parser.</p>
<h3>Where do I report bugs or rendering issues? <span id="where-do-i-report-bugs-or-rendering-issues"></span><a href="#where-do-i-report-bugs-or-rendering-issues" class="hashlink">&para;</a></h3><p>Just <a href="https://github.com/cebe/markdown/issues/new">open an issue</a> on github, post your markdown code and describe the problem. You may also attach screenshots of the rendered HTML result to describe your problem.</p>
<h3>How can I contribute to this library? <span id="how-can-i-contribute-to-this-library"></span><a href="#how-can-i-contribute-to-this-library" class="hashlink">&para;</a></h3><p>Check the <a href="guide-CONTRIBUTING.html">CONTRIBUTING.md</a> file for more info.</p>
<h3>Am I free to use this? <span id="am-i-free-to-use-this"></span><a href="#am-i-free-to-use-this" class="hashlink">&para;</a></h3><p>This library is open source and licensed under the <a href="http://opensource.org/licenses/MIT">MIT License</a>. This means that you can do whatever you want
with it as long as you mention my name and include the <a href="https://github.com/cebe/markdown/blob/master/LICENSE">license file</a>. Check the <a href="https://github.com/cebe/markdown/blob/master/LICENSE">license</a> for details.</p>
<h2>Contact <span id="contact"></span><a href="#contact" class="hashlink">&para;</a></h2><p>Feel free to contact me using <a href="mailto:mail@cebe.cc">email</a> or <a href="https://twitter.com/cebe_cc">twitter</a>.</p>
        <div class="toplink"><a href="#" class="h1" title="go to top"><span class="glyphicon glyphicon-arrow-up"></a></div>
    </div>
</div>


</div>

<footer class="footer">
        <p class="pull-right"><small>Page generated on Tue, 09 Aug 2016 07:18:26 +0000</small></p>
    Powered by <a href="http://www.yiiframework.com/" rel="external">Yii Framework</a></footer>

<script type="text/javascript">jQuery(document).ready(function () {
    var shiftWindow = function () { scrollBy(0, -50) };
    if (location.hash) setTimeout(shiftWindow, 1);
    window.addEventListener("hashchange", shiftWindow);
var element = document.createElement("script");
element.src = "./jssearch.index.js";
document.body.appendChild(element);

var searchBox = $('#searchbox');

// search when typing in search field
searchBox.on("keyup", function(event) {
    var query = $(this).val();

    if (query == '' || event.which == 27) {
        $('#search-resultbox').hide();
        return;
    } else if (event.which == 13) {
        var selectedLink = $('#search-resultbox a.selected');
        if (selectedLink.length != 0) {
            document.location = selectedLink.attr('href');
            return;
        }
    } else if (event.which == 38 || event.which == 40) {
        $('#search-resultbox').show();

        var selected = $('#search-resultbox a.selected');
        if (selected.length == 0) {
            $('#search-results').find('a').first().addClass('selected');
        } else {
            var next;
            if (event.which == 40) {
                next = selected.parent().next().find('a').first();
            } else {
                next = selected.parent().prev().find('a').first();
            }
            if (next.length != 0) {
                var resultbox = $('#search-results');
                var position = next.position();

//              TODO scrolling is buggy and jumps around
//                resultbox.scrollTop(Math.floor(position.top));
//                console.log(position.top);

                selected.removeClass('selected');
                next.addClass('selected');
            }
        }

        return;
    }
    $('#search-resultbox').show();
    $('#search-results').html('<li><span class="no-results">No results</span></li>');

    var result = jssearch.search(query);

    if (result.length > 0) {
        var i = 0;
        var resHtml = '';

        for (var key in result) {
            if (i++ > 20) {
                break;
            }
            resHtml = resHtml +
            '<li><a href="' + result[key].file.u.substr(3) +'"><span class="title">' + result[key].file.t + '</span>' +
            '<span class="description">' + result[key].file.d + '</span></a></li>';
        }
        $('#search-results').html(resHtml);
    }
});

// hide the search results on ESC
$(document).on("keyup", function(event) { if (event.which == 27) { $('#search-resultbox').hide(); } });
// hide search results on click to document
$(document).bind('click', function (e) { $('#search-resultbox').hide(); });
// except the following:
searchBox.bind('click', function(e) { e.stopPropagation(); });
$('#search-resultbox').bind('click', function(e) { e.stopPropagation(); });

});</script></body>
</html>
